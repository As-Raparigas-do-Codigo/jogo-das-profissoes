name: Publish

on:
  push:
    branches: [ deploy ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    container: qautomatron/docker-webdav-disk:latest
    steps:
      - uses: actions/checkout@v2
      - run: |
          echo "Runs inside a container"
      - name: Corre docker
        run: docker run -d \
          -e WEBDAV_USER=${{ secrets.JDP_USER }} \
          -e WEBDAV_PASSWORD=${{ secrets.JDP_PWD }} \
          -e WEBDAV_URL=https://jogodasprofissoes.pt:2078 \
          --name jdp-webdav \
          --privileged \
          --cap-add=ALL \
          -v /dev:/dev  \
          -v /lib/modules:/lib/modules \          
          qautomatron/docker-webdav-disk
      - name: Arranca shell
        run: docker exec -it jdp-webdav /bin/bash
      - name: Lista conte√∫dos da pasta
        run: ls -la /mnt/cloud
      - name: Clona o project
        run: git clone https://github.com/As-Raparigas-do-Codigo/jogo-das-profissoes.git